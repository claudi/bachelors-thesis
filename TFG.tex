\RequirePackage[l2tabu]{nag}
\documentclass[a4paper]{article}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{lmodern}
\usepackage{microtype}
\usepackage{tikz}
\usetikzlibrary{cd}
\usepackage[hidelinks, pdfencoding=auto]{hyperref}

\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{example}[theorem]{Example}

\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{notation}[theorem]{Notation}

\DeclareMathOperator{\Obj}{Obj}
\DeclareMathOperator{\Hom}{Hom}

\newcommand{\id}{\mathrm{id}}

\newcommand{\cat}[1]{\mathcal{#1}}

\title{Monads in Haskell}
\author{Claudi Lleyda Molt√≥}
\date{}

\begin{document}
\maketitle
\tableofcontents
\clearpage
\section{Monads in Category Theory}
\subsection{Introduction to Category Theory}

\begin{definition}[Category]
    \label{def:category}
    A \emph{category}~\(\cat{C}\) is composed of a collection~\(\Obj(\cat{C})\)
    of \emph{objects}, for every two objects~\(A,B\in\Obj(\cat{C})\) a
    set~\(\Hom_{\cat{C}}(A,B)\) of \emph{morphisms} and a \emph{composition function}
    \[
        \circ:\Hom_{\cat{C}}(A,B)\times\Hom_{\cat{C}}(B,C) \longrightarrow
        \Hom_{\cat{C}}(A,C)
    \]
    that satisfies
    \begin{enumerate}
        \item \emph{Associativity}: for every three
            morphisms~\(f\in\Hom_{\cat{C}}(A,B)\),~\(g\in\Hom_{\cat{C}}(B,C)\) and~\(h\in\Hom_{\cat{C}}(C,D)\)
            we have
            \[
                f \circ (g \circ h) = (f \circ g) \circ h.
            \]
        \item \emph{Left and right units}: for every two
            objects~\(A,B\in\Obj(\cat{C})\) there exist unique
            elements~\(\id_{A}\in\Hom_{\cat{C}}(A,A)\),~\(\id_{B}\in\Hom_{\cat{C}}(B,B)\) such that
            for every morphism~\(f\in\Hom_{\cat{C}}(A,B)\) we have
            \[
                \id_{A} \circ f = f = f \circ \id_{B}.
            \]
    \end{enumerate}
\end{definition}

\begin{notation}
    We write~\(f:A\longrightarrow B\) or~\(A\overset{f}{\longrightarrow}B\) to
    mean~\(f\in\Hom_{\cat{C}}(A,B)\) and~\(fg\) to mean~\(f\circ g\).
\end{notation}

\begin{definition}[Functor]
    \label{def:functor}
    A~\emph{functor}~\(T\) from a category~\(\cat{C}\) to a category~\(\cat{D}\)
    is a map~\(T:\Obj(\cat{C})\longrightarrow\Obj(\cat{D})\), and for every
    morphism~\(f:A\longrightarrow B\) in~\(\cat{C}\) a
    morphism~\(T(f):T(A)\longrightarrow T(B)\) in~\(\cat{D}\), such that~\(T\)
    preserves
    \begin{enumerate}
        \item \emph{Composition}: for every two
            morphisms~\(f:A\longrightarrow B\),~\(g:B\longrightarrow C\)
            in~\(\cat{C}\) we have
            \[
                T(f \circ g) = T(f) \circ T(g).
            \]
        \item \emph{Units}: for each object~\(C\in\Obj{C}\) we have
            \[
                T(\id_{C}) = \id_{T(C)}.
            \]
    \end{enumerate}
\end{definition}

\begin{notation}
    We write~\(T:\cat{C}\longrightarrow\cat{D}\) to mean~\(T\) is a functor from
    a category~\(\cat{C}\) to a category~\(\cat{D}\).
    We may also shorten~\(T(A)\) to~\(TA\) or~\(T(f)\) to~\(Tf\), given~\(A\) an
    object in~\(\cat{C}\) and~\(f\) a morphism in~\(\cat{C}\).
\end{notation}

\begin{definition}[Natural transformation]
    \label{def:natural-transformation}
    Let~\(S,T:\cat{C}\longrightarrow\cat{D}\) be functors. A \emph{natural
    transformation}~\(\tau:S\longrightarrow T\) is a
    family~\(\tau=\{\tau_{A}:SA\longrightarrow TA\}_{A\in\Obj(A)}\) of morphisms
    in~\(\cat{B}\) such that for every morphishm~\(f:A\longrightarrow B\)
    in~\(\cat{A}\)
    \[
        \tau_{A} \circ Tf = Sf \circ \tau_{B},
    \]
    that is, making the following diagram commutative
    \[
        \begin{tikzcd}
            SA \arrow[r, "\tau_{A}"] \arrow[d, "Sf"] & TA \arrow[d, "Tf"] \\
            SB \arrow[r, "\tau_{B}"] & TB
        \end{tikzcd}
    \]
\end{definition}

\subsection{Monads}
\begin{definition}[Monad]
    \label{def:monad}
    A~\emph{monad} over a category~\(\cat{C}\) is a triple~\((T,\eta,\mu)\)
    where~\(T:\cat{C}\longrightarrow\cat{C}\) is a functor
    and~\(\eta:\id\longrightarrow T\) and~\(\mu:TT\longrightarrow T\) are two
    natural transformations such that for every object~\(X\in\Obj(\cat{C})\) the
    diagrams
    \[
        \begin{tikzcd}
            TX \arrow[r, "T\eta_{X}"] & TTX \arrow[d, "\mu_{X}"] & TX \arrow[l,
            swap, "\eta_{TX}"] \\
                                      & TX \arrow[ul, equal] \arrow[ur, equal] &
        \end{tikzcd}
        \qquad\text{and}\qquad
        \begin{tikzcd}
            TTTX \arrow[r, "\mu_{TX}"] \arrow[d, "T\mu_{X}"] & TTX \arrow[d,
            "\mu_{X}"] \\
            TTX \arrow[r, "\mu_{X}"] & TX
        \end{tikzcd}
    \]
    are commutative. This is
    \[
        \mu_{X}\circ T\eta_{X} = \id_{TX} = \mu_{X}\circ\eta_{TX}
        \qquad\text{and}\qquad
        \mu_{X}\circ \mu_{TX}
        = \mu_{X} \circ T\mu_{X}.
    \]
\end{definition}

\begin{example}[Pointed set monad]
\end{example}
\begin{example}[Words monad]
\end{example}

\section{The Kleisli Category in Computer Science}
\subsection{Motivation}
\begin{example}[Partiality]
\end{example}
\begin{example}[Non-determinism]
\end{example}
\begin{example}[Side-effects]
\end{example}
\begin{example}[Exceptions]
\end{example}

\subsection{Kleisli Triple}
\begin{definition}[Kleisli Triple]
    We define a \emph{Kleisli Triple} over a category~\(\cat{C}\)
    as a triple~\((T, \mu, (-)^{\ast})\) consisting of
    \begin{enumerate}
        \item a class function
            \(T:\Obj(\cat{C})\longrightarrow\Obj(\cat{C})\).
        \item \(\forall A\in\cat{C}\)
            a morphism~\(\eta_{A}:A\longrightarrow TA\)
            in~\(\cat{C}\).
        \item \(\forall f:A\longrightarrow TB\)
            a morphism~\(f^{\ast}:TA\longrightarrow TB\).
    \end{enumerate}
    such that
    \begin{enumerate}
        \item \(\forall A\in\cat{C}\) we have
            \(\eta^{\ast}_{TA} = 1_{TA}:TA\longrightarrow TA\).
        \item \(\forall A,B\in\cat{C}\)
            and \(\forall f:A\longrightarrow TB\)
            the diagram
            \[\begin{tikzcd}
                TA \arrow[r, "f^{\ast}"] & TB \\
                A \arrow[u, "\eta_{A}"] \arrow[ur, "f", swap] &
            \end{tikzcd}\]
            commutes. This is~\(f^{\ast}\circ\eta_{A} = f\).
        \item \(g^{\ast}\circ f^{\ast} = (g^{\ast}\circ f)^{\ast}\)
    \end{enumerate}
\end{definition}

\begin{proposition}
    There is a bijective correspondence between Kleisli triples and monads.
\end{proposition}
\begin{proof}
    Let~\((T, \mu, (-)^{\ast})\) be a Kleisli triple
    and set
    \begin{align*}
        T:\cat{C} & \longrightarrow\cat{C} \\
        C & \longmapsto TC \\
        f:C\rightarrow C' & \longmapsto
        (\eta_{C'}\circ f)^{\ast}:TC\longrightarrow TC'
    \end{align*}
    and
    \[
        \mu_{A} = (1_{TA})^{\ast}.
    \]

    Let's check that~\(T\) is a functor.
    For every~\(f:C_{1}\longrightarrow C_{2}\)
    and~\(g:{2}\longrightarrow C_{3}\)
    \begin{align*}
        Tg\circ Tf &= (\eta_{C_{3}}\circ g)^{\ast}\circ
                      (\eta_{C_{2}}\circ f)^{\ast} \\
                   &= \bigl((\eta_{C_{3}}\circ g)^{\ast}\circ
                      (\eta_{C_{2}}\circ f)\bigr)^{\ast} \\
                   &= \bigl((\eta_{C_{3}}\circ g)^{\ast}\circ
                      \eta_{C_{2}}\circ f\bigr)^{\ast} \\
                   &= (\eta_{C_{3}}\circ g\circ f)^{\ast} \\
                   &= T(g\circ f)
    \end{align*}
    and for all~\(c\in\cat{C}\),
    \[
        T1_{C} = (\eta_{C}\circ 1_{C})^{\ast} = \eta_{C}^{\ast} = 1_{TC}.
    \]
\end{proof}

\section{The Kleisli Category and monads}
\subsection{Adjuntions}
\begin{definition}[Adjuction]
\end{definition}
\begin{proposition}
    Equivalent definitions to adjunction.
\end{proposition}
\begin{proposition}
    Every adjunction induces a monad.
\end{proposition}
\begin{proposition}
    Every monad induces an adjunction.
\end{proposition}
\subsection{Free \texorpdfstring{$\mathbb{T}$}{T}-algebras}
\begin{definition}[Free $\mathbb{T}$-algebras]
\end{definition}
\subsection{The Kleisli Category}
\begin{proposition}
    That statement on free $\mathbb{T}$-algebras and the Kleisli Category.
\end{proposition}

\section{Monads in Haskell}
\subsection{Haskell}
\subsection{The monad typeclass}
\subsection{Haskell monads are monads}
\subsection{Kleisli triples are Haskell monads}

\end{document}

